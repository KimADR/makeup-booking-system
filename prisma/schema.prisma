datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id    String @id @default(uuid())
  name  String
  email String @unique
  phone String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  reservations Reservation[]
  customer Customer?
  makeupArtist MakeupArtist?
}

model Customer {
  user       User @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId     String @unique
  preferences String[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model MakeupArtist {
  user         User @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId       String @unique
  portfolio    String[]
  availability Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model MakeupService {
  serviceId String @id @default(uuid())
  name      String
  duration  Int
  price     Float
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  reservations Reservation[]
}

model Reservation {
  reservationId String @id @default(uuid())
  date          DateTime
  time          String?
  status        ReservationStatus @default(Pending)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  user          User @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId        String
  makeupService MakeupService @relation(fields: [serviceId], references: [serviceId], onDelete: Cascade)
  serviceId     String
  payment       Payment?

  @@index([userId])
  @@index([serviceId])
  @@index([date])
}

model Payment {
  paymentId String @id @default(uuid())
  amount    Float
  status    PaymentStatus @default(Pending)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  reservation Reservation @relation(fields: [reservationId], references: [reservationId], onDelete: Cascade)
  reservationId String @unique

  @@index([reservationId])
}

enum ReservationStatus {
  Confirmed
  Pending
  Cancelled
}

enum PaymentStatus {
  Completed
  Pending
  Failed
}
